{"ast":null,"code":"var _jsxFileName = \"/app/frontend/src/components/pages/ThreadDetailPage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../hooks';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction ThreadDetailPage({\n  params,\n  navigateTo\n}) {\n  _s();\n  const {\n    user,\n    isAuthenticated,\n    api\n  } = useAuth();\n  const [thread, setThread] = useState(null);\n  const [newPost, setNewPost] = useState('');\n  const [posting, setPosting] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [replyingTo, setReplyingTo] = useState(null);\n  const [expandedReplies, setExpandedReplies] = useState({});\n  const [userReactions, setUserReactions] = useState({}); // CRITICAL FIX: Track user reactions\n\n  const fetchThreadData = async () => {\n    setLoading(true);\n    try {\n      console.log('🔍 ThreadDetailPage: Fetching REAL thread data for ID:', params.id);\n\n      // CRITICAL FIX: Use correct forum thread endpoint\n      try {\n        var _threadResponse$data;\n        const threadResponse = await api.get(`/forums/threads/${params.id}`);\n        const realThread = (threadResponse === null || threadResponse === void 0 ? void 0 : (_threadResponse$data = threadResponse.data) === null || _threadResponse$data === void 0 ? void 0 : _threadResponse$data.data) || (threadResponse === null || threadResponse === void 0 ? void 0 : threadResponse.data);\n        if (realThread && realThread.id) {\n          var _realThread$author, _realThread$author2, _realThread$author3, _realThread$author4, _realThread$author5, _realThread$author6;\n          // Transform backend thread data to frontend format\n          const transformedThread = {\n            id: realThread.id,\n            title: realThread.title,\n            author: {\n              id: realThread.user_id || ((_realThread$author = realThread.author) === null || _realThread$author === void 0 ? void 0 : _realThread$author.id) || 1,\n              name: realThread.user_name || ((_realThread$author2 = realThread.author) === null || _realThread$author2 === void 0 ? void 0 : _realThread$author2.name) || 'Unknown User',\n              avatar: ((_realThread$author3 = realThread.author) === null || _realThread$author3 === void 0 ? void 0 : _realThread$author3.avatar) || \"🎮\",\n              posts: ((_realThread$author4 = realThread.author) === null || _realThread$author4 === void 0 ? void 0 : _realThread$author4.posts_count) || 1,\n              joined: ((_realThread$author5 = realThread.author) === null || _realThread$author5 === void 0 ? void 0 : _realThread$author5.created_at) || \"2024-01-01\",\n              rank: ((_realThread$author6 = realThread.author) === null || _realThread$author6 === void 0 ? void 0 : _realThread$author6.rank) || \"User\"\n            },\n            content: realThread.content || \"No content available\",\n            createdAt: realThread.created_at || new Date().toISOString(),\n            views: realThread.views || realThread.views_count || 0,\n            replies: realThread.replies || realThread.replies_count || 0,\n            locked: realThread.locked || false,\n            pinned: realThread.pinned || false,\n            reactions: [{\n              type: '👍',\n              count: realThread.likes || 0,\n              userReacted: false\n            }, {\n              type: '👎',\n              count: realThread.dislikes || 0,\n              userReacted: false\n            }],\n            posts: [] // Comments will be fetched separately if available\n          };\n          console.log('✅ ThreadDetailPage: Using REAL backend thread data');\n          setThread(transformedThread);\n\n          // Initialize expanded state and user reactions\n          setExpandedReplies({});\n          setUserReactions({});\n          setLoading(false);\n          return;\n        }\n      } catch (backendError) {\n        console.log('⚠️ ThreadDetailPage: Backend thread not found, using mock data for ID:', params.id);\n      }\n\n      // Fallback to mock data if backend fails\n      const mockThread = getMockThreadById(params.id);\n      setThread(mockThread);\n\n      // Initialize expanded state for comments with replies\n      const expanded = {};\n      mockThread.posts.forEach(post => {\n        if (post.replies && post.replies.length > 0) {\n          expanded[post.id] = true;\n        }\n      });\n      setExpandedReplies(expanded);\n      setUserReactions({});\n    } catch (error) {\n      console.error('❌ ThreadDetailPage: Error fetching thread:', error);\n      const mockThread = getMockThreadById(params.id);\n      setThread(mockThread);\n    }\n    setLoading(false);\n  };\n\n  // CRITICAL FIX: Get mock thread by ID with proper mapping\n  const getMockThreadById = threadId => {\n    const allMockThreads = {\n      1: {\n        id: 1,\n        title: \"Iron Man broken in meta\",\n        author: {\n          id: 1,\n          name: \"CompetitiveGamer2024\",\n          avatar: \"🎮\",\n          posts: 342,\n          joined: \"2024-03-15\",\n          rank: \"Super Fan\"\n        },\n        content: \"His Repulsors do way too much damage and his mobility with the Arc Reactor flight makes him nearly impossible to counter. In ranked matches, whoever picks Iron Man first basically wins. The damage output is insane - 200+ DPS with perfect accuracy at any range. This needs to be addressed immediately.\",\n        createdAt: new Date().toISOString(),\n        views: 4567,\n        replies: 89,\n        locked: false,\n        pinned: false,\n        reactions: [{\n          type: '👍',\n          count: 127,\n          userReacted: false\n        }, {\n          type: '👎',\n          count: 23,\n          userReacted: false\n        }],\n        posts: getMockPostsForThread(1)\n      },\n      13: {\n        id: 13,\n        title: \"World Championship 2025 - Predictions and Discussion\",\n        author: {\n          id: 3,\n          name: \"Johnny Rodriguez\",\n          avatar: \"🏆\",\n          posts: 156,\n          joined: \"2024-01-01\",\n          rank: \"Tournament Admin\"\n        },\n        content: \"The Marvel Rivals World Championship 2025 is starting soon! What are your predictions for the top teams? Which heroes will dominate the meta? Let's discuss strategies and potential upsets.\",\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),\n        views: 1247,\n        replies: 89,\n        locked: false,\n        pinned: true,\n        reactions: [{\n          type: '👍',\n          count: 201,\n          userReacted: false\n        }, {\n          type: '👎',\n          count: 18,\n          userReacted: false\n        }],\n        posts: getMockPostsForThread(13)\n      }\n    };\n    return allMockThreads[threadId] || allMockThreads[1]; // Default to thread 1 if not found\n  };\n\n  // Generate mock posts for different threads\n  const getMockPostsForThread = threadId => {\n    const basePosts = [{\n      id: 2,\n      parentId: null,\n      author: {\n        id: 2,\n        name: \"TankMaster_Pro\",\n        avatar: \"🛡️\",\n        posts: 156,\n        joined: \"2024-06-20\",\n        rank: \"Moderator\"\n      },\n      content: threadId === 13 ? \"I think Team Stark Industries will take it all. Their coordination in the recent matches has been incredible, especially Tony's Iron Man plays.\" : \"I disagree. Iron Man requires skill to play effectively. His damage is high but he's very squishy. A good Hulk or Thor can shut him down easily.\",\n      createdAt: new Date(Date.now() - 3 * 60 * 60 * 1000).toISOString(),\n      reactions: [{\n        type: '👍',\n        count: 45,\n        userReacted: false\n      }, {\n        type: '👎',\n        count: 12,\n        userReacted: false\n      }],\n      replies: [{\n        id: 4,\n        parentId: 2,\n        author: {\n          id: 4,\n          name: threadId === 13 ? \"ChampionshipWatcher\" : \"IronManMain\",\n          avatar: threadId === 13 ? \"👀\" : \"🔥\",\n          posts: 89,\n          joined: \"2024-08-10\",\n          rank: \"Fan\"\n        },\n        content: threadId === 13 ? \"Agreed! But don't sleep on Team Lightning. Storm's gameplay has been revolutionary this season.\" : \"@TankMaster_Pro Exactly! People complaining about Iron Man just don't know how to counter him. Play around cover and close the distance.\",\n        createdAt: new Date(Date.now() - 2.5 * 60 * 60 * 1000).toISOString(),\n        reactions: [{\n          type: '👍',\n          count: 23,\n          userReacted: false\n        }, {\n          type: '👎',\n          count: 8,\n          userReacted: false\n        }],\n        replies: []\n      }]\n    }, {\n      id: 3,\n      parentId: null,\n      author: {\n        id: 3,\n        name: threadId === 13 ? \"ProAnalyst\" : \"SpiderManFan\",\n        avatar: threadId === 13 ? \"📊\" : \"🕷️\",\n        posts: 178,\n        joined: \"2024-07-12\",\n        rank: \"Fan\"\n      },\n      content: threadId === 13 ? \"The meta is going to be crucial. I predict we'll see a lot of Support compositions in the finals. Teams that can sustain fights longer will have the advantage.\" : \"The problem isn't just his damage - it's the combination of mobility + damage + range. No other character has all three at this level.\",\n      createdAt: new Date(Date.now() - 1.5 * 60 * 60 * 1000).toISOString(),\n      reactions: [{\n        type: '👍',\n        count: 89,\n        userReacted: false\n      }, {\n        type: '👎',\n        count: 7,\n        userReacted: false\n      }],\n      replies: []\n    }];\n    return basePosts;\n  };\n  useEffect(() => {\n    if (params.id) {\n      fetchThreadData();\n    }\n  }, [params.id]);\n\n  // CRITICAL FIX: Enhanced reaction handling with 1 reaction per user limit\n  const handleReaction = async (postId, type) => {\n    if (!isAuthenticated) {\n      window.dispatchEvent(new CustomEvent('mrvl-show-auth-modal'));\n      return;\n    }\n    console.log(`🔗 ThreadDetailPage: Reacting to post ${postId} with ${type}`);\n    const reactionKey = `${postId}-${type}`;\n    const hasReacted = userReactions[reactionKey];\n\n    // CRITICAL FIX: Clear all other reactions for this post (limit 1 per user per post)\n    const clearOtherReactions = posts => {\n      return posts.map(post => {\n        if (post.id === postId) {\n          return {\n            ...post,\n            reactions: post.reactions.map(reaction => {\n              if (reaction.type === type) {\n                // Toggle this reaction\n                const newCount = hasReacted ? reaction.count - 1 : reaction.count + 1;\n                return {\n                  ...reaction,\n                  count: Math.max(0, newCount),\n                  userReacted: !hasReacted\n                };\n              } else {\n                // Clear other reactions for this user\n                const otherReactionKey = `${postId}-${reaction.type}`;\n                const hadOtherReaction = userReactions[otherReactionKey];\n                if (hadOtherReaction) {\n                  return {\n                    ...reaction,\n                    count: Math.max(0, reaction.count - 1),\n                    userReacted: false\n                  };\n                }\n                return reaction;\n              }\n            })\n          };\n        }\n        if (post.replies) {\n          return {\n            ...post,\n            replies: clearOtherReactions(post.replies)\n          };\n        }\n        return post;\n      });\n    };\n\n    // Update user reactions tracking\n    const newUserReactions = {\n      ...userReactions\n    };\n\n    // Clear all reactions for this post\n    Object.keys(newUserReactions).forEach(key => {\n      if (key.startsWith(`${postId}-`)) {\n        delete newUserReactions[key];\n      }\n    });\n\n    // Set new reaction if not removing\n    if (!hasReacted) {\n      newUserReactions[reactionKey] = true;\n    }\n    setUserReactions(newUserReactions);\n    if (postId === 'main') {\n      setThread(prev => ({\n        ...prev,\n        reactions: prev.reactions.map(reaction => {\n          if (reaction.type === type) {\n            const newCount = hasReacted ? reaction.count - 1 : reaction.count + 1;\n            return {\n              ...reaction,\n              count: Math.max(0, newCount),\n              userReacted: !hasReacted\n            };\n          } else {\n            // Clear other reactions for main post\n            const otherReactionKey = `main-${reaction.type}`;\n            const hadOtherReaction = userReactions[otherReactionKey];\n            if (hadOtherReaction) {\n              return {\n                ...reaction,\n                count: Math.max(0, reaction.count - 1),\n                userReacted: false\n              };\n            }\n            return reaction;\n          }\n        })\n      }));\n    } else {\n      setThread(prev => ({\n        ...prev,\n        posts: clearOtherReactions(prev.posts)\n      }));\n    }\n  };\n\n  // Enhanced post submission with nested reply support\n  const handlePostSubmit = async e => {\n    e.preventDefault();\n    if (!newPost.trim() || posting) return;\n    setPosting(true);\n    try {\n      console.log(`Submitting ${replyingTo ? 'nested reply' : 'post'}:`, newPost);\n      const newPostObj = {\n        id: Date.now(),\n        parentId: replyingTo,\n        author: {\n          id: (user === null || user === void 0 ? void 0 : user.id) || 999,\n          name: (user === null || user === void 0 ? void 0 : user.name) || 'Anonymous',\n          avatar: (user === null || user === void 0 ? void 0 : user.avatar) || \"👤\",\n          posts: 1,\n          joined: \"2024-12-01\",\n          rank: \"Rookie\"\n        },\n        content: newPost,\n        createdAt: new Date().toISOString(),\n        reactions: [{\n          type: '👍',\n          count: 0,\n          userReacted: false\n        }, {\n          type: '👎',\n          count: 0,\n          userReacted: false\n        }],\n        replies: []\n      };\n      if (replyingTo) {\n        // Add nested reply\n        const addNestedReply = posts => {\n          return posts.map(post => {\n            if (post.id === replyingTo) {\n              return {\n                ...post,\n                replies: [...(post.replies || []), newPostObj]\n              };\n            }\n            if (post.replies) {\n              return {\n                ...post,\n                replies: addNestedReply(post.replies)\n              };\n            }\n            return post;\n          });\n        };\n        setThread(prev => ({\n          ...prev,\n          posts: addNestedReply(prev.posts),\n          replies: prev.replies + 1\n        }));\n\n        // Auto-expand the parent comment to show new reply\n        setExpandedReplies(prev => ({\n          ...prev,\n          [replyingTo]: true\n        }));\n      } else {\n        // Add top-level comment\n        setThread(prev => ({\n          ...prev,\n          posts: [...prev.posts, newPostObj],\n          replies: prev.replies + 1\n        }));\n      }\n      setNewPost('');\n      setReplyingTo(null);\n    } catch (error) {\n      console.error('Error posting reply:', error);\n    }\n    setPosting(false);\n  };\n\n  // Toggle nested replies visibility\n  const toggleReplies = postId => {\n    setExpandedReplies(prev => ({\n      ...prev,\n      [postId]: !prev[postId]\n    }));\n  };\n  const formatDate = dateString => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffMs = now - date;\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n    if (diffMins < 60) return `${diffMins}m ago`;\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${diffDays}d ago`;\n  };\n  const ReactionButton = ({\n    reaction,\n    postId\n  }) => {\n    const reactionKey = `${postId}-${reaction.type}`;\n    const hasUserReacted = userReactions[reactionKey] || reaction.userReacted;\n    return /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => handleReaction(postId, reaction.type),\n      className: `flex items-center space-x-1 px-2 py-1 rounded text-xs transition-colors ${hasUserReacted ? 'bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 border border-red-300 dark:border-red-600' : 'bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600'}`,\n      disabled: !isAuthenticated,\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: reaction.type\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 406,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"font-medium\",\n        children: reaction.count\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 7\n    }, this);\n  };\n\n  // Enhanced PostCard with nested comment support\n  const PostCard = ({\n    post,\n    isMainPost = false,\n    depth = 0\n  }) => {\n    const hasReplies = post.replies && post.replies.length > 0;\n    const isExpanded = expandedReplies[post.id];\n    const maxDepth = 3;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `${isMainPost ? '' : depth > 0 ? 'ml-8 border-l-2 border-gray-200 dark:border-gray-600 pl-4' : ''}`,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: `flex space-x-3 ${isMainPost ? 'pb-4' : 'py-3'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"w-8 h-8 rounded bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-sm\",\n            children: post.author.avatar\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 423,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 min-w-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-2 mb-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"font-medium text-gray-900 dark:text-white text-sm\",\n              children: post.author.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 432,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded\",\n              children: post.author.rank\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 435,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-xs text-gray-500 dark:text-gray-500\",\n              children: formatDate(post.createdAt)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 438,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 431,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-sm text-gray-900 dark:text-white mb-3 leading-relaxed\",\n            children: post.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 444,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center space-x-3\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center space-x-2\",\n              children: post.reactions.map((reaction, index) => /*#__PURE__*/_jsxDEV(ReactionButton, {\n                reaction: reaction,\n                postId: isMainPost ? 'main' : post.id\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 453,\n                columnNumber: 19\n              }, this))\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 451,\n              columnNumber: 15\n            }, this), !isMainPost && depth < maxDepth && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => {\n                if (!isAuthenticated) {\n                  window.dispatchEvent(new CustomEvent('mrvl-show-auth-modal'));\n                  return;\n                }\n                setReplyingTo(post.id);\n              },\n              className: \"text-xs text-gray-500 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors\",\n              children: \"Reply\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 463,\n              columnNumber: 17\n            }, this), hasReplies && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => toggleReplies(post.id),\n              className: \"text-xs text-blue-600 dark:text-blue-400 hover:underline\",\n              children: [isExpanded ? 'Hide' : 'Show', \" \", post.replies.length, \" \", post.replies.length === 1 ? 'reply' : 'replies']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 479,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 449,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 11\n        }, this), isMainPost && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-shrink-0 text-right\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500 dark:text-gray-500 space-y-1\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: [post.author.posts, \" posts\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 493,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [\"Joined \", new Date(post.author.joined).toLocaleDateString()]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 494,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 492,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 491,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 420,\n        columnNumber: 9\n      }, this), hasReplies && isExpanded && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2\",\n        children: post.replies.map(reply => /*#__PURE__*/_jsxDEV(PostCard, {\n          post: reply,\n          isMainPost: false,\n          depth: depth + 1\n        }, reply.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 504,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 502,\n        columnNumber: 11\n      }, this), replyingTo === post.id && isAuthenticated && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-3 ml-11 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded p-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-xs text-gray-600 dark:text-gray-400 mb-2\",\n          children: [\"Replying to @\", post.author.name]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          onSubmit: handlePostSubmit,\n          className: \"space-y-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            value: newPost,\n            onChange: e => setNewPost(e.target.value),\n            placeholder: `Reply to ${post.author.name}...`,\n            rows: 3,\n            className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 521,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-end space-x-2\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => {\n                setReplyingTo(null);\n                setNewPost('');\n              },\n              className: \"px-3 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\",\n              children: \"Cancel\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 530,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              disabled: posting || !newPost.trim(),\n              className: \"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n              children: posting ? 'Posting...' : 'Reply'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 540,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 529,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 520,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 516,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 419,\n      columnNumber: 7\n    }, this);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl mb-4\",\n          children: \"\\uD83D\\uDCAC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 dark:text-gray-400\",\n          children: \"Loading post...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 557,\n      columnNumber: 7\n    }, this);\n  }\n  if (!thread) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"max-w-4xl mx-auto\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center py-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-4xl mb-4\",\n          children: \"\\u274C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 570,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          className: \"text-lg font-semibold text-gray-900 dark:text-white mb-2\",\n          children: \"Post not found\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 571,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigateTo && navigateTo('forums'),\n          className: \"text-red-600 dark:text-red-400 hover:underline\",\n          children: \"Back to Forums\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 572,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 569,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 568,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-4xl mx-auto\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => navigateTo && navigateTo('forums'),\n          className: \"text-red-600 dark:text-red-400 hover:underline text-sm\",\n          children: \"\\u2190 Back to Forums\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 588,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-sm text-gray-500 dark:text-gray-500\",\n          children: [thread.views.toLocaleString(), \" views \\u2022 \", thread.replies, \" replies\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 594,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 587,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 586,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"px-4 py-3 border-b border-gray-200 dark:border-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-lg font-semibold text-gray-900 dark:text-white\",\n          children: thread.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 604,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-4 mt-1 text-xs text-gray-500 dark:text-gray-500\",\n          children: [thread.pinned && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-red-600 dark:text-red-400\",\n            children: \"\\uD83D\\uDCCC Pinned\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 609,\n            columnNumber: 15\n          }, this), thread.locked && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-yellow-600 dark:text-yellow-400\",\n            children: \"\\uD83D\\uDD12 Locked\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 612,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 607,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 603,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"divide-y divide-gray-200 dark:divide-gray-600\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4\",\n          children: /*#__PURE__*/_jsxDEV(PostCard, {\n            post: {\n              ...thread,\n              author: thread.author\n            },\n            isMainPost: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 621,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 620,\n          columnNumber: 11\n        }, this), thread.posts.map(post => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"p-4\",\n          children: /*#__PURE__*/_jsxDEV(PostCard, {\n            post: post,\n            depth: 0\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 627,\n            columnNumber: 15\n          }, this)\n        }, post.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 626,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 618,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 601,\n      columnNumber: 7\n    }, this), isAuthenticated && !thread.locked && !replyingTo ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4 card p-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-sm font-medium text-gray-900 dark:text-white mb-3\",\n        children: \"Reply to Post\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 636,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handlePostSubmit,\n        className: \"space-y-3\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          value: newPost,\n          onChange: e => setNewPost(e.target.value),\n          placeholder: \"Share your thoughts...\",\n          rows: 4,\n          className: \"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\",\n          required: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 638,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center justify-between\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-600 dark:text-gray-400\",\n            children: [\"Posting as \", (user === null || user === void 0 ? void 0 : user.name) || 'Anonymous']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 647,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            disabled: posting || !newPost.trim(),\n            className: \"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\",\n            children: posting ? 'Posting...' : 'Post Reply'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 650,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 646,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 637,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 9\n    }, this) : !isAuthenticated ?\n    /*#__PURE__*/\n    /* Sign-in prompt for non-authenticated users */\n    _jsxDEV(\"div\", {\n      className: \"mt-4 card p-4 text-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-sm font-medium text-gray-900 dark:text-white mb-2\",\n        children: \"Join the Discussion\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 663,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-xs text-gray-600 dark:text-gray-400 mb-3\",\n        children: \"Sign in to reply to this post and share your thoughts with the community.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 664,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          window.dispatchEvent(new CustomEvent('mrvl-show-auth-modal'));\n        },\n        className: \"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors\",\n        children: \"Sign In to Reply\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 667,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 662,\n      columnNumber: 9\n    }, this) : thread.locked ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-4 card p-4 text-center\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-xs text-gray-600 dark:text-gray-400\",\n        children: \"This post is locked and no longer accepting replies.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 678,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 677,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 584,\n    columnNumber: 5\n  }, this);\n}\n_s(ThreadDetailPage, \"JGAmVcr2sRiT3/QGstvUTq4JsGE=\", false, function () {\n  return [useAuth];\n});\n_c = ThreadDetailPage;\nexport default ThreadDetailPage;\nvar _c;\n$RefreshReg$(_c, \"ThreadDetailPage\");","map":{"version":3,"names":["React","useState","useEffect","useAuth","jsxDEV","_jsxDEV","ThreadDetailPage","params","navigateTo","_s","user","isAuthenticated","api","thread","setThread","newPost","setNewPost","posting","setPosting","loading","setLoading","replyingTo","setReplyingTo","expandedReplies","setExpandedReplies","userReactions","setUserReactions","fetchThreadData","console","log","id","_threadResponse$data","threadResponse","get","realThread","data","_realThread$author","_realThread$author2","_realThread$author3","_realThread$author4","_realThread$author5","_realThread$author6","transformedThread","title","author","user_id","name","user_name","avatar","posts","posts_count","joined","created_at","rank","content","createdAt","Date","toISOString","views","views_count","replies","replies_count","locked","pinned","reactions","type","count","likes","userReacted","dislikes","backendError","mockThread","getMockThreadById","expanded","forEach","post","length","error","threadId","allMockThreads","getMockPostsForThread","now","basePosts","parentId","handleReaction","postId","window","dispatchEvent","CustomEvent","reactionKey","hasReacted","clearOtherReactions","map","reaction","newCount","Math","max","otherReactionKey","hadOtherReaction","newUserReactions","Object","keys","key","startsWith","prev","handlePostSubmit","e","preventDefault","trim","newPostObj","addNestedReply","toggleReplies","formatDate","dateString","date","diffMs","diffMins","floor","diffHours","diffDays","ReactionButton","hasUserReacted","onClick","className","disabled","children","fileName","_jsxFileName","lineNumber","columnNumber","PostCard","isMainPost","depth","hasReplies","isExpanded","maxDepth","index","toLocaleDateString","reply","onSubmit","value","onChange","target","placeholder","rows","required","toLocaleString","_c","$RefreshReg$"],"sources":["/app/frontend/src/components/pages/ThreadDetailPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../hooks';\n\nfunction ThreadDetailPage({ params, navigateTo }) {\n  const { user, isAuthenticated, api } = useAuth();\n  const [thread, setThread] = useState(null);\n  const [newPost, setNewPost] = useState('');\n  const [posting, setPosting] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [replyingTo, setReplyingTo] = useState(null);\n  const [expandedReplies, setExpandedReplies] = useState({});\n  const [userReactions, setUserReactions] = useState({}); // CRITICAL FIX: Track user reactions\n\n  const fetchThreadData = async () => {\n    setLoading(true);\n    try {\n      console.log('🔍 ThreadDetailPage: Fetching REAL thread data for ID:', params.id);\n      \n      // CRITICAL FIX: Use correct forum thread endpoint\n      try {\n        const threadResponse = await api.get(`/forums/threads/${params.id}`);\n        const realThread = threadResponse?.data?.data || threadResponse?.data;\n        \n        if (realThread && realThread.id) {\n          // Transform backend thread data to frontend format\n          const transformedThread = {\n            id: realThread.id,\n            title: realThread.title,\n            author: {\n              id: realThread.user_id || realThread.author?.id || 1,\n              name: realThread.user_name || realThread.author?.name || 'Unknown User',\n              avatar: realThread.author?.avatar || \"🎮\",\n              posts: realThread.author?.posts_count || 1,\n              joined: realThread.author?.created_at || \"2024-01-01\",\n              rank: realThread.author?.rank || \"User\"\n            },\n            content: realThread.content || \"No content available\",\n            createdAt: realThread.created_at || new Date().toISOString(),\n            views: realThread.views || realThread.views_count || 0,\n            replies: realThread.replies || realThread.replies_count || 0,\n            locked: realThread.locked || false,\n            pinned: realThread.pinned || false,\n            reactions: [\n              { type: '👍', count: realThread.likes || 0, userReacted: false },\n              { type: '👎', count: realThread.dislikes || 0, userReacted: false }\n            ],\n            posts: [] // Comments will be fetched separately if available\n          };\n          \n          console.log('✅ ThreadDetailPage: Using REAL backend thread data');\n          setThread(transformedThread);\n          \n          // Initialize expanded state and user reactions\n          setExpandedReplies({});\n          setUserReactions({});\n          \n          setLoading(false);\n          return;\n        }\n      } catch (backendError) {\n        console.log('⚠️ ThreadDetailPage: Backend thread not found, using mock data for ID:', params.id);\n      }\n      \n      // Fallback to mock data if backend fails\n      const mockThread = getMockThreadById(params.id);\n      setThread(mockThread);\n      \n      // Initialize expanded state for comments with replies\n      const expanded = {};\n      mockThread.posts.forEach(post => {\n        if (post.replies && post.replies.length > 0) {\n          expanded[post.id] = true;\n        }\n      });\n      setExpandedReplies(expanded);\n      setUserReactions({});\n      \n    } catch (error) {\n      console.error('❌ ThreadDetailPage: Error fetching thread:', error);\n      const mockThread = getMockThreadById(params.id);\n      setThread(mockThread);\n    }\n    setLoading(false);\n  };\n\n  // CRITICAL FIX: Get mock thread by ID with proper mapping\n  const getMockThreadById = (threadId) => {\n    const allMockThreads = {\n      1: {\n        id: 1,\n        title: \"Iron Man broken in meta\",\n        author: {\n          id: 1,\n          name: \"CompetitiveGamer2024\",\n          avatar: \"🎮\",\n          posts: 342,\n          joined: \"2024-03-15\",\n          rank: \"Super Fan\"\n        },\n        content: \"His Repulsors do way too much damage and his mobility with the Arc Reactor flight makes him nearly impossible to counter. In ranked matches, whoever picks Iron Man first basically wins. The damage output is insane - 200+ DPS with perfect accuracy at any range. This needs to be addressed immediately.\",\n        createdAt: new Date().toISOString(),\n        views: 4567,\n        replies: 89,\n        locked: false,\n        pinned: false,\n        reactions: [\n          { type: '👍', count: 127, userReacted: false },\n          { type: '👎', count: 23, userReacted: false }\n        ],\n        posts: getMockPostsForThread(1)\n      },\n      13: {\n        id: 13,\n        title: \"World Championship 2025 - Predictions and Discussion\",\n        author: {\n          id: 3,\n          name: \"Johnny Rodriguez\",\n          avatar: \"🏆\",\n          posts: 156,\n          joined: \"2024-01-01\",\n          rank: \"Tournament Admin\"\n        },\n        content: \"The Marvel Rivals World Championship 2025 is starting soon! What are your predictions for the top teams? Which heroes will dominate the meta? Let's discuss strategies and potential upsets.\",\n        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),\n        views: 1247,\n        replies: 89,\n        locked: false,\n        pinned: true,\n        reactions: [\n          { type: '👍', count: 201, userReacted: false },\n          { type: '👎', count: 18, userReacted: false }\n        ],\n        posts: getMockPostsForThread(13)\n      }\n    };\n\n    return allMockThreads[threadId] || allMockThreads[1]; // Default to thread 1 if not found\n  };\n\n  // Generate mock posts for different threads\n  const getMockPostsForThread = (threadId) => {\n    const basePosts = [\n      {\n        id: 2,\n        parentId: null,\n        author: {\n          id: 2,\n          name: \"TankMaster_Pro\",\n          avatar: \"🛡️\",\n          posts: 156,\n          joined: \"2024-06-20\",\n          rank: \"Moderator\"\n        },\n        content: threadId === 13 ? \"I think Team Stark Industries will take it all. Their coordination in the recent matches has been incredible, especially Tony's Iron Man plays.\" : \"I disagree. Iron Man requires skill to play effectively. His damage is high but he's very squishy. A good Hulk or Thor can shut him down easily.\",\n        createdAt: new Date(Date.now() - 3 * 60 * 60 * 1000).toISOString(),\n        reactions: [\n          { type: '👍', count: 45, userReacted: false },\n          { type: '👎', count: 12, userReacted: false }\n        ],\n        replies: [\n          {\n            id: 4,\n            parentId: 2,\n            author: {\n              id: 4,\n              name: threadId === 13 ? \"ChampionshipWatcher\" : \"IronManMain\",\n              avatar: threadId === 13 ? \"👀\" : \"🔥\",\n              posts: 89,\n              joined: \"2024-08-10\",\n              rank: \"Fan\"\n            },\n            content: threadId === 13 ? \"Agreed! But don't sleep on Team Lightning. Storm's gameplay has been revolutionary this season.\" : \"@TankMaster_Pro Exactly! People complaining about Iron Man just don't know how to counter him. Play around cover and close the distance.\",\n            createdAt: new Date(Date.now() - 2.5 * 60 * 60 * 1000).toISOString(),\n            reactions: [\n              { type: '👍', count: 23, userReacted: false },\n              { type: '👎', count: 8, userReacted: false }\n            ],\n            replies: []\n          }\n        ]\n      },\n      {\n        id: 3,\n        parentId: null,\n        author: {\n          id: 3,\n          name: threadId === 13 ? \"ProAnalyst\" : \"SpiderManFan\",\n          avatar: threadId === 13 ? \"📊\" : \"🕷️\",\n          posts: 178,\n          joined: \"2024-07-12\",\n          rank: \"Fan\"\n        },\n        content: threadId === 13 ? \"The meta is going to be crucial. I predict we'll see a lot of Support compositions in the finals. Teams that can sustain fights longer will have the advantage.\" : \"The problem isn't just his damage - it's the combination of mobility + damage + range. No other character has all three at this level.\",\n        createdAt: new Date(Date.now() - 1.5 * 60 * 60 * 1000).toISOString(),\n        reactions: [\n          { type: '👍', count: 89, userReacted: false },\n          { type: '👎', count: 7, userReacted: false }\n        ],\n        replies: []\n      }\n    ];\n\n    return basePosts;\n  };\n\n  useEffect(() => {\n    if (params.id) {\n      fetchThreadData();\n    }\n  }, [params.id]);\n\n  // CRITICAL FIX: Enhanced reaction handling with 1 reaction per user limit\n  const handleReaction = async (postId, type) => {\n    if (!isAuthenticated) {\n      window.dispatchEvent(new CustomEvent('mrvl-show-auth-modal'));\n      return;\n    }\n\n    console.log(`🔗 ThreadDetailPage: Reacting to post ${postId} with ${type}`);\n    \n    const reactionKey = `${postId}-${type}`;\n    const hasReacted = userReactions[reactionKey];\n    \n    // CRITICAL FIX: Clear all other reactions for this post (limit 1 per user per post)\n    const clearOtherReactions = (posts) => {\n      return posts.map(post => {\n        if (post.id === postId) {\n          return {\n            ...post,\n            reactions: post.reactions.map(reaction => {\n              if (reaction.type === type) {\n                // Toggle this reaction\n                const newCount = hasReacted ? reaction.count - 1 : reaction.count + 1;\n                return { ...reaction, count: Math.max(0, newCount), userReacted: !hasReacted };\n              } else {\n                // Clear other reactions for this user\n                const otherReactionKey = `${postId}-${reaction.type}`;\n                const hadOtherReaction = userReactions[otherReactionKey];\n                if (hadOtherReaction) {\n                  return { ...reaction, count: Math.max(0, reaction.count - 1), userReacted: false };\n                }\n                return reaction;\n              }\n            })\n          };\n        }\n        if (post.replies) {\n          return { ...post, replies: clearOtherReactions(post.replies) };\n        }\n        return post;\n      });\n    };\n\n    // Update user reactions tracking\n    const newUserReactions = { ...userReactions };\n    \n    // Clear all reactions for this post\n    Object.keys(newUserReactions).forEach(key => {\n      if (key.startsWith(`${postId}-`)) {\n        delete newUserReactions[key];\n      }\n    });\n    \n    // Set new reaction if not removing\n    if (!hasReacted) {\n      newUserReactions[reactionKey] = true;\n    }\n    \n    setUserReactions(newUserReactions);\n\n    if (postId === 'main') {\n      setThread(prev => ({\n        ...prev,\n        reactions: prev.reactions.map(reaction => {\n          if (reaction.type === type) {\n            const newCount = hasReacted ? reaction.count - 1 : reaction.count + 1;\n            return { ...reaction, count: Math.max(0, newCount), userReacted: !hasReacted };\n          } else {\n            // Clear other reactions for main post\n            const otherReactionKey = `main-${reaction.type}`;\n            const hadOtherReaction = userReactions[otherReactionKey];\n            if (hadOtherReaction) {\n              return { ...reaction, count: Math.max(0, reaction.count - 1), userReacted: false };\n            }\n            return reaction;\n          }\n        })\n      }));\n    } else {\n      setThread(prev => ({\n        ...prev,\n        posts: clearOtherReactions(prev.posts)\n      }));\n    }\n  };\n\n  // Enhanced post submission with nested reply support\n  const handlePostSubmit = async (e) => {\n    e.preventDefault();\n    if (!newPost.trim() || posting) return;\n\n    setPosting(true);\n    try {\n      console.log(`Submitting ${replyingTo ? 'nested reply' : 'post'}:`, newPost);\n      \n      const newPostObj = {\n        id: Date.now(),\n        parentId: replyingTo,\n        author: {\n          id: user?.id || 999,\n          name: user?.name || 'Anonymous',\n          avatar: user?.avatar || \"👤\",\n          posts: 1,\n          joined: \"2024-12-01\",\n          rank: \"Rookie\"\n        },\n        content: newPost,\n        createdAt: new Date().toISOString(),\n        reactions: [\n          { type: '👍', count: 0, userReacted: false },\n          { type: '👎', count: 0, userReacted: false }\n        ],\n        replies: []\n      };\n\n      if (replyingTo) {\n        // Add nested reply\n        const addNestedReply = (posts) => {\n          return posts.map(post => {\n            if (post.id === replyingTo) {\n              return {\n                ...post,\n                replies: [...(post.replies || []), newPostObj]\n              };\n            }\n            if (post.replies) {\n              return { ...post, replies: addNestedReply(post.replies) };\n            }\n            return post;\n          });\n        };\n\n        setThread(prev => ({\n          ...prev,\n          posts: addNestedReply(prev.posts),\n          replies: prev.replies + 1\n        }));\n\n        // Auto-expand the parent comment to show new reply\n        setExpandedReplies(prev => ({\n          ...prev,\n          [replyingTo]: true\n        }));\n      } else {\n        // Add top-level comment\n        setThread(prev => ({\n          ...prev,\n          posts: [...prev.posts, newPostObj],\n          replies: prev.replies + 1\n        }));\n      }\n\n      setNewPost('');\n      setReplyingTo(null);\n    } catch (error) {\n      console.error('Error posting reply:', error);\n    }\n    setPosting(false);\n  };\n\n  // Toggle nested replies visibility\n  const toggleReplies = (postId) => {\n    setExpandedReplies(prev => ({\n      ...prev,\n      [postId]: !prev[postId]\n    }));\n  };\n\n  const formatDate = (dateString) => {\n    const date = new Date(dateString);\n    const now = new Date();\n    const diffMs = now - date;\n    const diffMins = Math.floor(diffMs / 60000);\n    const diffHours = Math.floor(diffMs / 3600000);\n    const diffDays = Math.floor(diffMs / 86400000);\n\n    if (diffMins < 60) return `${diffMins}m ago`;\n    if (diffHours < 24) return `${diffHours}h ago`;\n    return `${diffDays}d ago`;\n  };\n\n  const ReactionButton = ({ reaction, postId }) => {\n    const reactionKey = `${postId}-${reaction.type}`;\n    const hasUserReacted = userReactions[reactionKey] || reaction.userReacted;\n    \n    return (\n      <button\n        onClick={() => handleReaction(postId, reaction.type)}\n        className={`flex items-center space-x-1 px-2 py-1 rounded text-xs transition-colors ${\n          hasUserReacted\n            ? 'bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400 border border-red-300 dark:border-red-600'\n            : 'bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600'\n        }`}\n        disabled={!isAuthenticated}\n      >\n        <span>{reaction.type}</span>\n        <span className=\"font-medium\">{reaction.count}</span>\n      </button>\n    );\n  };\n\n  // Enhanced PostCard with nested comment support\n  const PostCard = ({ post, isMainPost = false, depth = 0 }) => {\n    const hasReplies = post.replies && post.replies.length > 0;\n    const isExpanded = expandedReplies[post.id];\n    const maxDepth = 3;\n\n    return (\n      <div className={`${isMainPost ? '' : depth > 0 ? 'ml-8 border-l-2 border-gray-200 dark:border-gray-600 pl-4' : ''}`}>\n        <div className={`flex space-x-3 ${isMainPost ? 'pb-4' : 'py-3'}`}>\n          {/* Avatar Column */}\n          <div className=\"flex-shrink-0\">\n            <div className=\"w-8 h-8 rounded bg-gray-200 dark:bg-gray-700 flex items-center justify-center text-sm\">\n              {post.author.avatar}\n            </div>\n          </div>\n\n          {/* Content Column */}\n          <div className=\"flex-1 min-w-0\">\n            {/* Header */}\n            <div className=\"flex items-center space-x-2 mb-2\">\n              <span className=\"font-medium text-gray-900 dark:text-white text-sm\">\n                {post.author.name}\n              </span>\n              <span className=\"text-xs px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 rounded\">\n                {post.author.rank}\n              </span>\n              <span className=\"text-xs text-gray-500 dark:text-gray-500\">\n                {formatDate(post.createdAt)}\n              </span>\n            </div>\n\n            {/* Content */}\n            <div className=\"text-sm text-gray-900 dark:text-white mb-3 leading-relaxed\">\n              {post.content}\n            </div>\n\n            {/* Actions Row */}\n            <div className=\"flex items-center space-x-3\">\n              {/* Reactions */}\n              <div className=\"flex items-center space-x-2\">\n                {post.reactions.map((reaction, index) => (\n                  <ReactionButton\n                    key={index}\n                    reaction={reaction}\n                    postId={isMainPost ? 'main' : post.id}\n                  />\n                ))}\n              </div>\n\n              {/* Reply button for nested comments */}\n              {!isMainPost && depth < maxDepth && (\n                <button\n                  onClick={() => {\n                    if (!isAuthenticated) {\n                      window.dispatchEvent(new CustomEvent('mrvl-show-auth-modal'));\n                      return;\n                    }\n                    setReplyingTo(post.id);\n                  }}\n                  className=\"text-xs text-gray-500 dark:text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors\"\n                >\n                  Reply\n                </button>\n              )}\n\n              {/* Toggle replies button */}\n              {hasReplies && (\n                <button\n                  onClick={() => toggleReplies(post.id)}\n                  className=\"text-xs text-blue-600 dark:text-blue-400 hover:underline\"\n                >\n                  {isExpanded ? 'Hide' : 'Show'} {post.replies.length} {post.replies.length === 1 ? 'reply' : 'replies'}\n                </button>\n              )}\n            </div>\n          </div>\n\n          {/* Stats Column (for main post only) */}\n          {isMainPost && (\n            <div className=\"flex-shrink-0 text-right\">\n              <div className=\"text-xs text-gray-500 dark:text-gray-500 space-y-1\">\n                <div>{post.author.posts} posts</div>\n                <div>Joined {new Date(post.author.joined).toLocaleDateString()}</div>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Nested Replies */}\n        {hasReplies && isExpanded && (\n          <div className=\"mt-2\">\n            {post.replies.map(reply => (\n              <PostCard\n                key={reply.id}\n                post={reply}\n                isMainPost={false}\n                depth={depth + 1}\n              />\n            ))}\n          </div>\n        )}\n\n        {/* Inline Reply Form */}\n        {replyingTo === post.id && isAuthenticated && (\n          <div className=\"mt-3 ml-11 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded p-3\">\n            <div className=\"text-xs text-gray-600 dark:text-gray-400 mb-2\">\n              Replying to @{post.author.name}\n            </div>\n            <form onSubmit={handlePostSubmit} className=\"space-y-2\">\n              <textarea\n                value={newPost}\n                onChange={(e) => setNewPost(e.target.value)}\n                placeholder={`Reply to ${post.author.name}...`}\n                rows={3}\n                className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\"\n                required\n              />\n              <div className=\"flex items-center justify-end space-x-2\">\n                <button\n                  type=\"button\"\n                  onClick={() => {\n                    setReplyingTo(null);\n                    setNewPost('');\n                  }}\n                  className=\"px-3 py-1 text-xs text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors\"\n                >\n                  Cancel\n                </button>\n                <button\n                  type=\"submit\"\n                  disabled={posting || !newPost.trim()}\n                  className=\"px-3 py-1 bg-red-600 text-white text-xs rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {posting ? 'Posting...' : 'Reply'}\n                </button>\n              </div>\n            </form>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (loading) {\n    return (\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"text-center py-8\">\n          <div className=\"text-2xl mb-4\">💬</div>\n          <p className=\"text-gray-600 dark:text-gray-400\">Loading post...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!thread) {\n    return (\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"text-center py-8\">\n          <div className=\"text-4xl mb-4\">❌</div>\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">Post not found</h3>\n          <button\n            onClick={() => navigateTo && navigateTo('forums')}\n            className=\"text-red-600 dark:text-red-400 hover:underline\"\n          >\n            Back to Forums\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"flex items-center space-x-4\">\n          <button\n            onClick={() => navigateTo && navigateTo('forums')}\n            className=\"text-red-600 dark:text-red-400 hover:underline text-sm\"\n          >\n            ← Back to Forums\n          </button>\n          <div className=\"text-sm text-gray-500 dark:text-gray-500\">\n            {thread.views.toLocaleString()} views • {thread.replies} replies\n          </div>\n        </div>\n      </div>\n\n      {/* Thread Content - VLR.gg Style */}\n      <div className=\"card\">\n        {/* Thread Title */}\n        <div className=\"px-4 py-3 border-b border-gray-200 dark:border-gray-600\">\n          <h1 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n            {thread.title}\n          </h1>\n          <div className=\"flex items-center space-x-4 mt-1 text-xs text-gray-500 dark:text-gray-500\">\n            {thread.pinned && (\n              <span className=\"text-red-600 dark:text-red-400\">📌 Pinned</span>\n            )}\n            {thread.locked && (\n              <span className=\"text-yellow-600 dark:text-yellow-400\">🔒 Locked</span>\n            )}\n          </div>\n        </div>\n\n        {/* Posts */}\n        <div className=\"divide-y divide-gray-200 dark:divide-gray-600\">\n          {/* Main Post */}\n          <div className=\"p-4\">\n            <PostCard post={{ ...thread, author: thread.author }} isMainPost={true} />\n          </div>\n\n          {/* Comments with Nested Replies */}\n          {thread.posts.map(post => (\n            <div key={post.id} className=\"p-4\">\n              <PostCard post={post} depth={0} />\n            </div>\n          ))}\n        </div>\n      </div>\n\n      {/* Main Reply Form (only for top-level comments) */}\n      {isAuthenticated && !thread.locked && !replyingTo ? (\n        <div className=\"mt-4 card p-4\">\n          <h3 className=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">Reply to Post</h3>\n          <form onSubmit={handlePostSubmit} className=\"space-y-3\">\n            <textarea\n              value={newPost}\n              onChange={(e) => setNewPost(e.target.value)}\n              placeholder=\"Share your thoughts...\"\n              rows={4}\n              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded bg-white dark:bg-gray-800 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent\"\n              required\n            />\n            <div className=\"flex items-center justify-between\">\n              <div className=\"text-xs text-gray-600 dark:text-gray-400\">\n                Posting as {user?.name || 'Anonymous'}\n              </div>\n              <button\n                type=\"submit\"\n                disabled={posting || !newPost.trim()}\n                className=\"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n              >\n                {posting ? 'Posting...' : 'Post Reply'}\n              </button>\n            </div>\n          </form>\n        </div>\n      ) : !isAuthenticated ? (\n        /* Sign-in prompt for non-authenticated users */\n        <div className=\"mt-4 card p-4 text-center\">\n          <h3 className=\"text-sm font-medium text-gray-900 dark:text-white mb-2\">Join the Discussion</h3>\n          <p className=\"text-xs text-gray-600 dark:text-gray-400 mb-3\">\n            Sign in to reply to this post and share your thoughts with the community.\n          </p>\n          <button\n            onClick={() => {\n              window.dispatchEvent(new CustomEvent('mrvl-show-auth-modal'));\n            }}\n            className=\"px-3 py-1.5 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors\"\n          >\n            Sign In to Reply\n          </button>\n        </div>\n      ) : thread.locked ? (\n        <div className=\"mt-4 card p-4 text-center\">\n          <p className=\"text-xs text-gray-600 dark:text-gray-400\">\n            This post is locked and no longer accepting replies.\n          </p>\n        </div>\n      ) : null}\n    </div>\n  );\n}\n\nexport default ThreadDetailPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}