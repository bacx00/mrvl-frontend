(()=>{var e={};e.id=111,e.ids=[111],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6487:()=>{},6902:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>p,serverHooks:()=>v,workAsyncStorage:()=>m,workUnitAsyncStorage:()=>h});var a={};r.r(a),r.d(a,{GET:()=>g,POST:()=>u});var n=r(6559),o=r(8088),i=r(7719),s=r(2190);!function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}();let c=Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).object({timeframe:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).enum(["1h","6h","24h","7d","30d"]).optional().default("24h"),category:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).string().optional(),limit:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).string().optional().transform(e=>e?parseInt(e):10),includeContent:Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).string().optional().transform(e=>"true"===e)}),d=[{id:"thread-1001",title:"Season 2 Meta Discussion - What Changed?",category:{id:"competitive",name:"Competitive Discussion",color:"#ef4444"},author:{id:"user123",username:"ProAnalyst",avatar:"/avatars/analyst.png",verified:!0},createdAt:new Date(Date.now()-144e5).toISOString(),stats:{views:2847,replies:89,likes:234,shares:12,lastActivity:new Date(Date.now()-3e5).toISOString()},engagement:{score:385.7,velocity:"high",trend:"rising",peakHour:15},tags:["meta","season-2","analysis","competitive"],preview:"The new season brought major changes to hero balance. Iron Man received significant nerfs while Storm got substantial buffs...",hotness:98.5,isPinned:!1,isLocked:!1},{id:"thread-1002",title:"BREAKING: TenZ announces retirement from competitive",category:{id:"competitive",name:"Competitive Discussion",color:"#ef4444"},author:{id:"user456",username:"EsportsNews",avatar:"/avatars/news.png",verified:!0},createdAt:new Date(Date.now()-72e5).toISOString(),stats:{views:5234,replies:167,likes:445,shares:34,lastActivity:new Date(Date.now()-6e4).toISOString()},engagement:{score:542.3,velocity:"high",trend:"rising",peakHour:16},tags:["tenz","retirement","sentinels","breaking"],preview:"In a shocking announcement, TenZ has announced his retirement from competitive Marvel Rivals to focus on content creation...",hotness:95.8,isPinned:!0,isLocked:!1},{id:"thread-1003",title:"New Iron Man combo discovered - 40% more damage",category:{id:"guides",name:"Guides & Strategy",color:"#10b981"},author:{id:"user789",username:"ComboMaster",avatar:"/avatars/combo.png",verified:!1},createdAt:new Date(Date.now()-288e5).toISOString(),stats:{views:1923,replies:73,likes:312,shares:28,lastActivity:new Date(Date.now()-9e5).toISOString()},engagement:{score:267.4,velocity:"medium",trend:"stable",peakHour:14},tags:["iron-man","combo","guide","tech"],preview:"Found a new Iron Man combo that increases damage output by 40%. Here's the input sequence and timing...",hotness:89.2,isPinned:!1,isLocked:!1},{id:"thread-1004",title:"Patch 2.1 Preview - Developer AMA Tomorrow",category:{id:"patch-notes",name:"Patch Notes & Updates",color:"#f59e0b"},author:{id:"dev1",username:"NetEaseDev",avatar:"/avatars/dev.png",verified:!0,role:"developer"},createdAt:new Date(Date.now()-216e5).toISOString(),stats:{views:3456,replies:234,likes:567,shares:45,lastActivity:new Date(Date.now()-18e4).toISOString()},engagement:{score:423.8,velocity:"high",trend:"rising",peakHour:17},tags:["patch-2.1","developer","ama","official"],preview:"Join us tomorrow at 3PM PST for a developer AMA about the upcoming Patch 2.1. We'll discuss balance changes, new features...",hotness:92.1,isPinned:!0,isLocked:!1},{id:"thread-1005",title:"Insane Storm play compilation - Must watch clips",category:{id:"memes",name:"Memes & Highlights",color:"#8b5cf6"},author:{id:"user321",username:"ClipCollector",avatar:"/avatars/clips.png",verified:!1},createdAt:new Date(Date.now()-432e5).toISOString(),stats:{views:4567,replies:45,likes:423,shares:67,lastActivity:new Date(Date.now()-15e5).toISOString()},engagement:{score:356.9,velocity:"medium",trend:"stable",peakHour:20},tags:["storm","highlights","clips","compilation"],preview:"Collected the best Storm plays from this week. Some absolutely insane weather control and team fight setups...",hotness:85.4,isPinned:!1,isLocked:!1},{id:"thread-1006",title:"Champions 2025 bracket predictions - Who wins?",category:{id:"competitive",name:"Competitive Discussion",color:"#ef4444"},author:{id:"user654",username:"BracketExpert",avatar:"/avatars/bracket.png",verified:!1},createdAt:new Date(Date.now()-648e5).toISOString(),stats:{views:2134,replies:156,likes:189,shares:23,lastActivity:new Date(Date.now()-48e4).toISOString()},engagement:{score:298.7,velocity:"medium",trend:"rising",peakHour:19},tags:["champions-2025","predictions","bracket","tournament"],preview:"With the Champions 2025 bracket finally revealed, let's discuss predictions. My dark horse pick is Paper Rex...",hotness:78.9,isPinned:!1,isLocked:!1},{id:"thread-1007",title:"Bug Report: Doctor Strange portal glitch still exists",category:{id:"bug-reports",name:"Bug Reports",color:"#f97316"},author:{id:"user987",username:"BugHunter",avatar:"/avatars/bug.png",verified:!1},createdAt:new Date(Date.now()-504e5).toISOString(),stats:{views:892,replies:34,likes:67,shares:8,lastActivity:new Date(Date.now()-27e5).toISOString()},engagement:{score:89.4,velocity:"low",trend:"stable",peakHour:13},tags:["bug-report","doctor-strange","portal","glitch"],preview:"The portal glitch where Doctor Strange gets stuck is still happening after the latest patch. Steps to reproduce...",hotness:45.2,isPinned:!1,isLocked:!1}],l=new Map;async function g(e){try{var t;let r;let a=e.headers.get("x-forwarded-for")||e.headers.get("x-real-ip")||"unknown";if(!function(e){let t=Date.now(),r=l.get(e);return!r||t>r.resetTime?(l.set(e,{count:1,resetTime:t+6e4}),!0):!(r.count>=50)&&(r.count++,!0)}(a))return s.NextResponse.json({error:"Rate limit exceeded. Please try again later."},{status:429});let{searchParams:n}=new URL(e.url),o=Object.fromEntries(n.entries());try{r=c.parse(o)}catch(e){if(e instanceof Object(function(){var e=Error("Cannot find module 'zod'");throw e.code="MODULE_NOT_FOUND",e}()).ZodError)return s.NextResponse.json({error:"Invalid query parameters",details:e.errors},{status:400})}let i=((t=r.category)?d.filter(e=>e.category.id===t):d).map(e=>({...e,trendingScore:function(e,t){let r=Date.now(),a=r-new Date(e.createdAt).getTime(),n=r-new Date(e.stats.lastActivity).getTime(),o={"1h":36e5,"6h":216e5,"24h":864e5,"7d":6048e5,"30d":2592e6}[t];if(a>o)return 0;let i=.1*e.stats.views+2*e.stats.replies+1.5*e.stats.likes+3*e.stats.shares;return i*=(1+Math.max(0,(o-n)/o))*({high:1.5,medium:1.2,low:1})[e.engagement.velocity]*({rising:1.3,stable:1,falling:.8})[e.engagement.trend],e.isPinned&&(i*=1.2),i}(e,r.timeframe)})).filter(e=>e.trendingScore>0);i.sort((e,t)=>t.trendingScore-e.trendingScore);let g=i.slice(0,r.limit),u=e.headers.get("user-agent")||"",p=/Mobile|Android|iPhone|iPad/.test(u),m=g;p&&!r.includeContent?m=g.map(e=>({id:e.id,title:e.title,category:{id:e.category.id,name:e.category.name,color:e.category.color},author:{username:e.author.username,verified:e.author.verified},stats:{views:e.stats.views,replies:e.stats.replies,likes:e.stats.likes},createdAt:e.createdAt,tags:e.tags.slice(0,3),hotness:e.hotness,trendingScore:Math.round(e.trendingScore)})):r.includeContent||(m=g.map(e=>{let{preview:t,...r}=e;return{...r,preview:t?.substring(0,150)+"..."}}));let h=g.reduce((e,t)=>{let r=t.category.id;return e[r]||(e[r]={id:r,name:t.category.name,color:t.category.color,count:0,totalScore:0}),e[r].count++,e[r].totalScore+=t.trendingScore,e},{}),v=Object.values(h).sort((e,t)=>t.totalScore-e.totalScore);return s.NextResponse.json({success:!0,data:m,meta:{timeframe:r.timeframe,category:r.category,limit:r.limit,total:i.length,timestamp:new Date().toISOString(),mobile:p},categoryStats:v,trending:{hottest:g[0]?.id||null,mostActive:g.find(e=>"high"===e.engagement.velocity)?.id||null,newest:g.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime())[0]?.id||null}})}catch(e){return console.error("Trending API error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}async function u(e){try{let{timeframe:t="24h",detailed:r=!1}=await e.json(),a={totalEngagement:d.reduce((e,t)=>e+t.stats.views+t.stats.replies+t.stats.likes,0),averageHotness:d.reduce((e,t)=>e+t.hotness,0)/d.length,categoryDistribution:{},hourlyActivity:Array(24).fill(0),topTags:{},engagementTrends:{rising:d.filter(e=>"rising"===e.engagement.trend).length,stable:d.filter(e=>"stable"===e.engagement.trend).length,falling:d.filter(e=>"falling"===e.engagement.trend).length}};d.forEach(e=>{let t=e.category.id;a.categoryDistribution[t]||(a.categoryDistribution[t]=0),a.categoryDistribution[t]++}),d.forEach(e=>{let t=e.engagement.peakHour;t>=0&&t<24&&a.hourlyActivity[t]++}),d.forEach(e=>{e.tags.forEach(e=>{a.topTags[e]||(a.topTags[e]=0),a.topTags[e]++})});let n=Object.entries(a.topTags).sort(([,e],[,t])=>t-e).slice(0,20).reduce((e,[t,r])=>(e[t]=r,e),{});return a.topTags=n,console.log(`[ANALYTICS] Trending statistics generated for ${t}`),s.NextResponse.json({success:!0,analytics:a,meta:{timeframe:t,detailed:r,generatedAt:new Date().toISOString(),totalTopics:d.length}})}catch(e){return console.error("Trending analytics error:",e),s.NextResponse.json({error:"Internal server error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/forums/trending/route",pathname:"/api/forums/trending",filename:"route",bundlePath:"app/api/forums/trending/route"},resolvedPagePath:"/var/www/mrvl-frontend/frontend/src/app/api/forums/trending/route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:m,workUnitAsyncStorage:h,serverHooks:v}=p;function w(){return(0,i.patchFetch)({workAsyncStorage:m,workUnitAsyncStorage:h})}},8335:()=>{},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,580],()=>r(6902));module.exports=a})();